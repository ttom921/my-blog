"use strict";(globalThis.webpackChunkmy_blog=globalThis.webpackChunkmy_blog||[]).push([[3488],{7926:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>i,contentTitle:()=>l,default:()=>a,frontMatter:()=>t,metadata:()=>s,toc:()=>h});const s=JSON.parse('{"id":"\u5b78\u7fd2/rust/rustbasic/rust_\u6cdb\u578b_Generics","title":"17-rust_\u6cdb\u578b_Generics","description":"_\u6cdb\u578b_Generics","source":"@site/docs/\u5b78\u7fd2/rust/rustbasic/17-rust_\u6cdb\u578b_Generics.md","sourceDirName":"\u5b78\u7fd2/rust/rustbasic","slug":"/\u5b78\u7fd2/rust/rustbasic/rust_\u6cdb\u578b_Generics","permalink":"/my-blog/docs/\u5b78\u7fd2/rust/rustbasic/rust_\u6cdb\u578b_Generics","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":17,"frontMatter":{"\uff03id":"doc-markdown","title":"17-rust_\u6cdb\u578b_Generics","description":"_\u6cdb\u578b_Generics","keywords":["rust"],"last_update":{"date":"4/22/2024","author":"ttom"}},"sidebar":"tutorialSidebar","previous":{"title":"16-rust_Option \u4e0d\u53ea\u662f\u500b\u9078\u9805","permalink":"/my-blog/docs/\u5b78\u7fd2/rust/rustbasic/rust_Option \u4e0d\u53ea\u662f\u500b\u9078\u9805"},"next":{"title":"18-rust_\u932f\u8aa4\u8655\u7406_Error Handling","permalink":"/my-blog/docs/\u5b78\u7fd2/rust/rustbasic/rust_\u932f\u8aa4\u8655\u7406_Error Handling"}}');var d=r(4848),c=r(8453);const t={"\uff03id":"doc-markdown",title:"17-rust_\u6cdb\u578b_Generics",description:"_\u6cdb\u578b_Generics",keywords:["rust"],last_update:{date:"4/22/2024",author:"ttom"}},l=void 0,i={},h=[{value:"\u591a\u500b\u4e0d\u540c\u578b\u5225",id:"\u591a\u500b\u4e0d\u540c\u578b\u5225",level:3},{value:"\u53c3\u6578\u4e5f\u80fd\u6cdb\u578b",id:"\u53c3\u6578\u4e5f\u80fd\u6cdb\u578b",level:3},{value:"\u975c\u614b\u5206\u767c vs \u52d5\u614b\u5206\u767c",id:"\u975c\u614b\u5206\u767c-vs-\u52d5\u614b\u5206\u767c",level:2}];function o(e){const n={code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,c.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(n.p,{children:"\u5047\u8a2d\u6211\u5b9a\u7fa9\u4e86\u4e00\u500b\u9577\u65b9\u578b\u7684 Struct\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-rust",children:"struct Rectangle {\r\n    width: u32,\r\n    height: u32,\r\n}\r\n\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u88e1\u9762\u6709 ",(0,d.jsx)(n.code,{children:"width"})," \u8ddf ",(0,d.jsx)(n.code,{children:"height"})," \u9019\u5169\u500b\u6b04\u4f4d\uff0c\u90fd\u662f ",(0,d.jsx)(n.code,{children:"u32"})," \u578b\u5225\u3002Rust \u5c0d\u578b\u5225\u7684\u8981\u6c42\u662f\u5f88\u56b4\u683c\u7684\uff0c\u8aaa\u597d\u7684 ",(0,d.jsx)(n.code,{children:"u32"})," \u5c31\u662f\u53ea\u80fd\u653e\u6574\u6578\uff0c\u7d66\u5b83\u5c0f\u6578\u7684\u8a71\u99ac\u4e0a Rust \u7de8\u8b6f\u5668\u5c31\u6703\u8df3\u51fa\u4f86\u62b1\u6028\u4e86\u3002"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-rust",children:"let rect_a = Rectangle{ width: 100, height: 50 };      // \u6c92\u554f\u984c\r\nlet rect_b = Rectangle{ width: 38.5, height: 19.5 };   // \u4e0d\u884c\uff01\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u5047\u8a2d\u6211\u5e0c\u671b\u9019\u500b ",(0,d.jsx)(n.code,{children:"Rectangle"})," \u7684\u6b04\u4f4d\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5c0f\u6578\u7684\u8a71\uff0c\u4f60\u53ef\u80fd\u60f3\u8aaa\u53ef\u4ee5\u6539\u6210\u5beb\u6210\u9019\u6a23\uff1a"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-rust",children:"struct RectangleU32 {\r\n    width: u32,\r\n    height: u32,\r\n}\r\n\r\nstruct RectangleF32 {\r\n    width: f32,\r\n    height: f32,\r\n}\r\n\n"})}),"\n",(0,d.jsx)(n.p,{children:"\u9019\u6a23\u5c31\u6c92\u554f\u984c\u4e86\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-rust",children:"let rect_a = RectangleI32{ width: 100, height: 50 };\r\nlet rect_b = RectangleF32{ width: 38.5, height: 19.5 };\n"})}),"\n",(0,d.jsx)(n.p,{children:"\u4f46\u5982\u679c\u9019\u6a23\u5beb\uff0c\u5f8c\u7e8c\u5982\u679c\u60f3\u8981\u5beb\u4e00\u500b\u53ef\u4ee5\u8a08\u7b97\u9762\u7a4d\u7684\u51fd\u6578\uff0c\u9019\u5169\u500b\u4e0d\u540c\u7684 Struct \u8981\u600e\u9ebc\u50b3\u9032\u53bb\u7576\u53c3\u6578\uff1f\u96e3\u9053\u4e5f\u8981\u5beb\u5169\u4efd\uff1f"}),"\n",(0,d.jsx)(n.p,{children:"\u4e0d\u540c\u7684\u7a0b\u5f0f\u8a9e\u8a00\u5728\u9762\u81e8\u9019\u6a23\u7684\u60c5\u5883\uff0c\u90fd\u6709\u985e\u4f3c\u7684\u8a2d\u8a08\uff0c\u6709\u4e9b\u7a0b\u5f0f\u8a9e\u8a00\u7a31\u4e4b\u300c\u6a21\u677f\uff08Template\uff09\u300d\uff0c\u6709\u4e9b\u5247\u7a31\u4e4b\u300c\u6cdb\u578b\uff08Generics\uff09\u300d\uff0c\u5c31\u5b57\u9762\u4e0a\u7684\u89e3\u91cb\u4f86\u8aaa\u6cdb\u578b\u4e26\u4e0d\u662f\u7279\u5b9a\u6307\u67d0\u4e00\u7a2e\u578b\u5225\uff0c\u800c\u662f\u7528\u4f86\u300c\u4ee3\u8868\u300d\u67d0\u500b\u578b\u5225\u3002\u5982\u679c\u9084\u662f\u89ba\u5f97\u6709\u9ede\u62bd\u8c61\uff0c\u6211\u5011\u4f86\u770b\u770b\u7a0b\u5f0f\u78bc\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-rust",children:"struct Rectangle<T> {\r\n    width: T,\r\n    height: T,\r\n}\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u9996\u5148\uff0c\u5728 Struct \u540d\u5b57\u7684\u6700\u5f8c\u9762\u7684 ",(0,d.jsx)(n.code,{children:"<T>"})," \u5c31\u662f Rust \u88e1\u6cdb\u578b\u7684\u6a19\u8a18\u5beb\u6cd5\uff0c\u8868\u793a\u5728\u9019\u500b Struct \u88e1\u6703\u6709\u4e00\u7a2e ",(0,d.jsx)(n.code,{children:"T"})," \u578b\u5225\u3002"]}),"\n",(0,d.jsxs)(n.p,{children:["\u86e4\uff1f\u4ec0\u9ebc\u662f ",(0,d.jsx)(n.code,{children:"T"})," \u578b\u5225\uff1f\u9019\u4f60\u4e0d\u7528\u7ba1\uff0c\u53cd\u6b63\u5b83\u5c31\u662f\u4e00\u7a2e\u578b\u5225\uff0c\u6216\u8aaa\u5b83\u5c31\u662f\u500b\u4f54\u4f4d\u7f6e\u7684 placeholder \u4e5f\u884c\uff0c\u5b83\u53ef\u4ee5\u662f\u6574\u6578\u3001\u6d6e\u9ede\u6578\u3001\u5e03\u6797\u503c\u6216\u5176\u5b83\u578b\u5225\u90fd\u53ef\u4ee5\uff0c\u6c92\u6709\u9650\u5b9a\u3002\u4ee5\u4e0a\u9762\u7684\u7bc4\u4f8b\u4f86\u8aaa\uff0c\u552f\u4e00\u78ba\u5b9a\u7684\u5c31\u662f ",(0,d.jsx)(n.code,{children:"width"})," \u8ddf ",(0,d.jsx)(n.code,{children:"height"})," \u9019\u5169\u500b\u6b04\u4f4d\u662f\u300c\u76f8\u540c\u7684 ",(0,d.jsx)(n.code,{children:"T"})," \u578b\u5225\u300d\u3002\u6b63\u662f\u56e0\u70ba\u5b83\u53ef\u4ee5\u5ee3\u300c\u6cdb\u300d\u7684\u4ee3\u8868\u67d0\u7a2e\u300c\u578b\u300d\u5225\uff0c\u624d\u7a31\u4e4b\u300c\u6cdb\u578b\u300d\u3002"]}),"\n",(0,d.jsxs)(n.p,{children:["\u5982\u679c\u4f60\u559c\u6b61\u7684\u8a71\uff0c\u4f60\u53ef\u4ee5\u628a\u9019\u500b ",(0,d.jsx)(n.code,{children:"T"})," \u63db\u6210\u4efb\u610f\u7684\u5927\u5beb\u958b\u982d\u7684\u5b57\uff0c\u50cf\u9019\u6a23\uff1a"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-rust",children:"struct Rectangle<RRRRRR> {\r\n    width: RRRRRR,\r\n    height: RRRRRR,\r\n}\r\n\n"})}),"\n",(0,d.jsxs)(n.p,{children:["Rust \u7de8\u8b6f\u5668\u4e0d\u6703\u62b1\u6028\uff0c\u4f46\u901a\u5e38\u6703\u770b\u5230\u5927\u5bb6\u4f7f\u7528 ",(0,d.jsx)(n.code,{children:"T"})," \u662f\u56e0\u70ba\u5b83\u6bd4\u8f03\u77ed\u800c\u4e14\u53ef\u4ee5\u7528\u4f86\u4ee3\u8868\u300c\u578b\u5225\uff08Type\uff09\u300d\uff0c\u751a\u81f3\u5728\u5176\u5b83\u6709\u652f\u63f4\u6cdb\u578b\u7684\u7a0b\u5f0f\u8a9e\u8a00\u4e5f\u90fd\u6703\u7528 ",(0,d.jsx)(n.code,{children:"T"}),"\u3002\u628a\u539f\u672c\u56fa\u5b9a\u5beb\u6b7b\u7684\u578b\u5225\u62bd\u63db\u6210 ",(0,d.jsx)(n.code,{children:"T"})," \u578b\u5225\u4e4b\u5f8c\uff0c\u4f7f\u7528\u8d77\u4f86\u5c31\u66f4\u6709\u5f48\u6027\u4e86\uff1a"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-rust",children:"let rect_a = Rectangle{ width: 100, height: 50 };\r\nlet rect_b = Rectangle{ width: 38.5, height: 19.5 };\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u73fe\u5728 ",(0,d.jsx)(n.code,{children:"Rectangle"})," \u7684\u6b04\u4f4d\u53ef\u4ee5\u7528\u6574\u6578\uff0c\u4e5f\u53ef\u4ee5\u7528\u5c0f\u6578\u4e86\u3002\u9019\u6a23\u7684\u6cdb\u578b\u5beb\u6cd5\u53ef\u4ee5\u8b93\u539f\u672c Struct \u66f4\u6709\u5f48\u6027\u4e86\uff0c\u4e0d\u9700\u8981\u4e00\u6a23\u7684\u6771\u897f\u5beb\u5f88\u591a\u6b21\u3002"]}),"\n",(0,d.jsxs)(n.p,{children:["\u6709\u8da3\u7684\u662f\uff0c\u96d6\u7136\u9019\u88e1\u4e26\u6c92\u6709\u6307\u5b9a\u7279\u5b9a\u578b\u5225\uff0c\u4f46\u7576 Rust \u5728\u7de8\u8b6f\u904e\u7a0b\u4e2d\u767c\u73fe\u4f60\u8981 ",(0,d.jsx)(n.code,{children:"u32"})," \u578b\u5225\uff0c\u90a3\u5b83\u5c31\u5728\u80cc\u5f8c\u5e6b\u4f60\u505a\u4e00\u500b ",(0,d.jsx)(n.code,{children:"u32"})," \u7684 Struct \u51fa\u4f86\uff0c\u4f60\u5e36 ",(0,d.jsx)(n.code,{children:"f32"})," \u7d66\u5b83\uff0c\u5b83\u5c31\u5e6b\u4f60\u505a\u4e00\u500b\u6b04\u4f4d\u662f ",(0,d.jsx)(n.code,{children:"f32"})," \u7684 Struct \u7d66\u4f60\uff0c\u9019\u500b\u884c\u70ba\u6709\u500b\u5c08\u6709\u540d\u8a5e\u53eb\u300c\u55ae\u578b\u5316 (Monomorphization)\u300d\uff1a"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-rust",children:"struct Rectangle_i32 {\r\n    width: i32,\r\n    height: i32,\r\n}\r\n\r\nstruct Rectangle_f32 {\r\n    width: f32,\r\n    height: f32,\r\n}\r\n\n"})}),"\n",(0,d.jsx)(n.p,{children:"\u5be6\u969b\u7522\u751f\u7684\u540d\u5b57\u61c9\u8a72\u66f4\u8907\u96dc\uff0c\u4f46\u9019\u4e9b\u90fd\u662f\u5728\u7de8\u8b6f\u6642\u671f Rust \u7de8\u8b6f\u5668\u5e6b\u4f60\u505a\u6389\u7684\uff0c\u6240\u4ee5\u96d6\u7136\u5728\u7de8\u8b6f\u7684\u968e\u6bb5\u6703\u591a\u82b1\u4e00\u9ede\u9ede\u7684\u6642\u9593\uff0c\u4f46\u57f7\u884c\u7684\u6642\u5019\u4e0d\u6703\u6709\u984d\u5916\u7684\u6210\u672c\uff0c\u6548\u80fd\u4e0d\u6703\u56e0\u70ba\u9019\u6a23\u800c\u6709\u6240\u6298\u6263\uff0c\u4e5f\u5c31\u662f Rust \u5b98\u65b9\u624b\u518a\u88e1\u6240\u63d0\u5230\u300c\u96f6\u6210\u672c\u62bd\u8c61\uff08Zero-Cost Abstractions\uff09\u300d\u7684\u6982\u5ff5\uff0c\u4f60\u4e0d\u7528\u624b\u52d5\u5beb\u51fa\u9019\u4e9b\u8cc7\u6599\u7d50\u69cb\u7684\u5be6\u969b\u578b\u5225\u3002"}),"\n",(0,d.jsx)(n.h3,{id:"\u591a\u500b\u4e0d\u540c\u578b\u5225",children:"\u591a\u500b\u4e0d\u540c\u578b\u5225"}),"\n",(0,d.jsxs)(n.p,{children:["\u627f\u4e0a\uff0c\u5982\u679c ",(0,d.jsx)(n.code,{children:"width"})," \u8ddf ",(0,d.jsx)(n.code,{children:"height"})," \u9019\u5169\u500b\u6b04\u4f4d\u6211\u60f3\u8981\u7d66\u5b83\u5011\u4e0d\u540c\u7684\u578b\u5225\u5462\uff1f\u6c92\u554f\u984c\uff0c\u4f60\u53ef\u4ee5\u9019\u6a23\u5beb\uff1a"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-rust",children:"struct Rectangle<T, U> {\r\n    width: T,\r\n    height: U,\r\n}\r\n\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u90a3\u500b ",(0,d.jsx)(n.code,{children:"U"})," \u5c31\u662f\u8868\u793a\u53e6\u4e00\u7a2e\u578b\u5225\u3002\u540c\u6a23\u7684\uff0c\u4f60\u60f3\u7528\u4ec0\u9ebc\u540d\u5b57\u90fd\u884c\uff0c\u4e0d\u904e\u6163\u4f8b\u4e0a\u6703\u4f7f\u7528 ",(0,d.jsx)(n.code,{children:"U"}),"\uff0c\u56e0\u70ba\u5b83\u6b63\u597d\u662f\u82f1\u6587\u5b57\u6bcd ",(0,d.jsx)(n.code,{children:"T"})," \u7684\u4e0b\u4e00\u500b\u5b57\uff0c\u5982\u679c\u9084\u6709\u66f4\u591a\u578b\u5225\u53c3\u6578\uff0c\u53ef\u4ee5\u7e7c\u7e8c\u5f80\u4e0b\u4f7f\u7528 ",(0,d.jsx)(n.code,{children:"V"}),"\u3001",(0,d.jsx)(n.code,{children:"W"})," \u4e4b\u985e\u7684\u5b57\u6bcd\u3002\uff08\u5c31\u8ddf\u70ba\u4ec0\u9ebc\u8ff4\u5708\u88e1\u5e38\u6703\u7528 ",(0,d.jsx)(n.code,{children:"i"})," \u8b8a\u6578\uff0c\u7136\u5f8c\u8ff4\u5708\u88e1\u7684\u8ff4\u5708\u6703\u7528 ",(0,d.jsx)(n.code,{children:"j"})," \u8b8a\u6578\u4e00\u6a23\u7684\u9053\u7406\uff09"]}),"\n",(0,d.jsxs)(n.p,{children:["\u6cdb\u578b\u4e0d\u662f\u53ea\u80fd\u7528\u5728 Struct \u4e0a\uff0cEnum \u8ddf Trait \u4e5f\u90fd\u80fd\u7528\u3002\u73fe\u5728\u5404\u4f4d\u518d\u56de\u60f3\u4e4b\u524d\u63d0\u5230\u7684 ",(0,d.jsx)(n.code,{children:"Option"})," \u8ddf ",(0,d.jsx)(n.code,{children:"Result"}),"\uff1a"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-rust",children:"pub enum Option<T> {\r\n    None,\r\n    Some(T),\r\n}\r\n\r\npub enum Result<T, E> {\r\n    Ok(T),\r\n    Err(E),\r\n}\r\n\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u5b83\u5011\u672c\u8eab\u4e5f\u662f\u7528\u4e86\u6cdb\u578b\u7684\u5beb\u6cd5\uff0c\u53e6\u5916\u6211\u5011\u5728\u4ecb\u7d39\u751f\u547d\u9031\u671f\u7684\u6642\u5019\u4e5f\u51fa\u73fe\u904e ",(0,d.jsx)(n.code,{children:"boss_cat<'a>"})," \u9019\u6a23\u7684\u5beb\u6cd5\uff0c\u5176\u4e2d\u7684 ",(0,d.jsx)(n.code,{children:"<>"})," \u4e5f\u662f\u6cdb\u578b\u3002\u73fe\u5728\u662f\u4e0d\u662f\u6bd4\u8f03\u80fd\u770b\u7684\u61c2\u4e86\u5462\uff1f"]}),"\n",(0,d.jsx)(n.h3,{id:"\u53c3\u6578\u4e5f\u80fd\u6cdb\u578b",children:"\u53c3\u6578\u4e5f\u80fd\u6cdb\u578b"}),"\n",(0,d.jsx)(n.p,{children:"\u4e0d\u53ea\u5982\u6b64\uff0c\u6cdb\u578b\u9084\u80fd\u7528\u5728\u51fd\u6578\u4e0a\u3002\u6211\u5f9e\u524d\u9762\u7684\u7ae0\u7bc0\u501f\u500b\u7bc4\u4f8b\u4f86\u7528\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-rust",children:"fn add_number(a: i32, b: i32) -> i32 {\r\n    a + b\r\n}\r\n\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u56e0\u70ba\u9019\u88e1\u7684 ",(0,d.jsx)(n.code,{children:"i32"})," \u90fd\u4e00\u6a23\uff0c\u5982\u679c\u6539\u7528\u6cdb\u578b\u7684\u5beb\u6cd5\u53ef\u4ee5\u8b8a\u6210\u9019\u6a23\uff1a"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-rust",children:"fn add_number<T>(a: T, b: T) -> T {\r\n    a + b\r\n}\r\n\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u9019\u9ebc\u4e00\u4f86\u9019\u500b ",(0,d.jsx)(n.code,{children:"add_number()"})," \u51fd\u6578\u53ef\u4ee5\u8655\u7406\u6574\u6578\u4e5f\u80fd\u8655\u7406\u6d6e\u9ede\u6578\uff0c\u597d\u50cf\u4e0d\u932f\u3002\u4f46\u7de8\u8b6f\u7684\u6642\u5019\u6703\u51fa\u73fe\u932f\u8aa4\u8a0a\u606f\uff1a"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-r",children:"$ cargo run          \r\nerror[E0369]: cannot add `T` to `T`\r\n23 |     a + b\r\n   |     - ^ - T\r\n   |     |\r\n   |     T\n"})}),"\n",(0,d.jsxs)(n.p,{children:["Rust \u544a\u8a34\u6211\u5011\u5b83\u6c92\u8fa6\u6cd5\u628a ",(0,d.jsx)(n.code,{children:"T"})," \u8ddf ",(0,d.jsx)(n.code,{children:"T"})," \u52a0\u5728\u4e00\u8d77\u3002\u54a6\uff1f\u6211\u672c\u4f86\u4ee5\u70ba Rust \u7de8\u8b6f\u5668\u9019\u9ebc\u8070\u660e\uff0c\u61c9\u8a72\u80fd\u5920\u731c\u7684\u51fa\u4f86 ",(0,d.jsx)(n.code,{children:"T"})," \u662f\u4ec0\u9ebc\u578b\u5225\uff0c\u770b\u4f86\u6211\u5011\u5f97\u8ddf\u5b83\u8b1b\u7684\u66f4\u6e05\u695a\u4e00\u9ede\u3002\u4f46\u5176\u5be6\u518d\u4ed4\u7d30\u60f3\u60f3\u4e5f\u5408\u7406\uff0c\u60f3\u60f3\u770b\uff0c\u56e0\u70ba\u9019\u500b ",(0,d.jsx)(n.code,{children:"T"})," \u53ef\u4ee5\u662f\u4efb\u610f\u578b\u5225\uff0c\u5982\u679c\u6211\u5beb\u6210 ",(0,d.jsx)(n.code,{children:"add_number(true, false)"})," \u786c\u662f\u7d66\u5b83 2 \u500b ",(0,d.jsx)(n.code,{children:"bool"})," \u578b\u5225\u7684\u503c\u7d66\u5b83\uff0c\u4f60\u662f\u8981\u5b83\u5011\u5169\u500b\u600e\u9ebc\u76f8\u52a0\uff1f"]}),"\n",(0,d.jsxs)(n.p,{children:["\u6240\u4ee5\u6211\u5011\u8981\u544a\u8a34 Rust\uff0c\u9019\u500b ",(0,d.jsx)(n.code,{children:"T"})," \u578b\u5225\u4e0d\u80fd\u662f\u96a8\u4fbf\u963f\u8c93\u963f\u72d7\u578b\u5225\u90fd\u53ef\u4ee5\uff0c\u5f97\u7d66\u5b83\u4e00\u4e9b\u300c\u9650\u5236\uff08Constraints\uff09\u300d\uff0c\u5728 Rust \u88e1\u6211\u5011\u53ef\u4ee5\u7d66\u9019\u500b ",(0,d.jsx)(n.code,{children:"T"})," \u578b\u5225\u67d0\u4e9b\u7279\u5fb5\uff08Trait\uff09\u3002\u4ee5\u4e0a\u9762\u7684\u9019\u500b\u52a0\u6cd5\u7684\u7bc4\u4f8b\u4f86\u8aaa\uff0c\u5728 Rust \u7684\u6a19\u6e96\u51fd\u5f0f\u5eab\u88e1\u6709\u4e00\u500b ",(0,d.jsx)(n.code,{children:"Add"})," \u7279\u5fb5\u53ef\u4ee5\u501f\u4f86\u7528\uff1a"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-rust",children:"fn add_number<T: std::ops::Add<Output = T>>(a: T, b: T) -> T {\r\n    a + b\r\n}\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u77e5\u9053\u9019\u500b\u8a9e\u6cd5\u5beb\u8d77\u4f86\u6709\u9ede\u8907\u96dc\u4e86\uff0c",(0,d.jsx)(n.code,{children:"std::ops::Add"})," \u662f\u6307\u5728 ",(0,d.jsx)(n.code,{children:"std"})," \u6a21\u7d44\u88e1\u7684 ",(0,d.jsx)(n.code,{children:"ops"})," \u6a21\u7d44\u88e1\u6709\u500b ",(0,d.jsx)(n.code,{children:"Add"})," \u7279\u5fb5\uff0c\u628a\u5b83\u639b\u5728 ",(0,d.jsx)(n.code,{children:"T"})," \u5f8c\u9762\u8868\u793a\u9019\u500b ",(0,d.jsx)(n.code,{children:"T"})," \u578b\u5225\u73fe\u5728\u5c31\u6709 ",(0,d.jsx)(n.code,{children:"Add"})," \u7684\u7279\u5fb5\u4e86\uff0c\u800c\u4e14 Rust \u5167\u5efa\u5c31\u5df2\u7d93\u5e6b ",(0,d.jsx)(n.code,{children:"Add"})," \u7279\u5fb5\u5be6\u4f5c\u4e86\u53ef\u4ee5\u76f8\u52a0\u7684\u529f\u80fd\u3002"]}),"\n",(0,d.jsxs)(n.p,{children:["\u5982\u679c\u89ba\u5f97 ",(0,d.jsx)(n.code,{children:"std::ops::Add"})," \u5beb\u8d77\u4f86\u6709\u9ede\u56c9\u55e6\uff0c\u53ef\u900f\u904e ",(0,d.jsx)(n.code,{children:"use"})," \u95dc\u9375\u5b57\u7a0d\u5fae\u4f86\u7c21\u5316\u5b83\uff1a"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-rust",children:"use std::ops::Add;\r\n\r\nfn add_number<T: Add<Output = T>>(a: T, b: T) -> T {\r\n    a + b\r\n}\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u8b93\u6211\u5011\u4f86\u8ffd\u4e00\u9ede\u9ede Rust \u7684\u539f\u59cb\u78bc\uff0c\u9a57\u8b49\u4e00\u4e0b\u6211\u5011\u525b\u525b\u4ecb\u7d39\u7684\u9019\u6bb5\u5167\u5bb9\u3002\u8ffd\u9032\u539f\u59cb\u78bc\u5c31\u6703\u767c\u73fe\uff0c",(0,d.jsx)(n.code,{children:"Add"})," \u5c31\u771f\u7684\u53ea\u662f\u4e00\u500b Trait\uff1a"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-rust",children:"pub trait Add<Rhs = Self> {\r\n    type Output;\r\n    fn add(self, rhs: Rhs) -> Self::Output;\r\n}\r\n\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u88e1\u9762\u9700\u8981\u5be6\u4f5c ",(0,d.jsx)(n.code,{children:"add"})," \u9019\u500b\u65b9\u6cd5\uff0c\u9019\u88e1\u4e5f\u53ef\u4ee5\u770b\u5230\u9019\u500b Trait \u672c\u8eab\u4e5f\u6709\u7528\u5230\u6cdb\u578b\uff0c\u525b\u525b\u5beb\u5230\u7684 ",(0,d.jsx)(n.code,{children:"Output"})," \u4e5f\u53ef\u4ee5\u5728\u9019\u88e1\u770b\u5230\u5b83\u3002\u518d\u5f80\u4e0b\u770b\u4e00\u9ede\u6703\u770b\u5230 Rust \u5e6b\u6211\u5011\u5beb\u597d\u7684\u5de8\u96c6\uff08Macro\uff09\uff1a"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-rust",children:"macro_rules! add_impl {\r\n    ($($t:ty)*) => ($(\r\n        impl Add for $t {\r\n            type Output = $t;\r\n            fn add(self, other: $t) -> $t { self + other }\r\n        }\r\n\r\n        forward_ref_binop! { impl Add, add for $t, $t }\r\n    )*)\r\n}\r\n\r\nadd_impl! { usize u8 u16 u32 u64 u128 isize i8 i16 i32 i64 i128 f32 f64 }\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u9019\u88e1\u4e0d\u9700\u8981\u6bcf\u500b\u8a9e\u6cd5\u90fd\u770b\u61c2\uff0c\u4f46\u5927\u6982\u80fd\u731c\u7684\u51fa\u4f86 ",(0,d.jsx)(n.code,{children:"add_impl!"})," \u9019\u500b\u5de8\u96c6\u6703\u5e6b\u6240\u6709\u7684\u6574\u6578\u578b\u5225\u4ee5\u53ca\u6d6e\u9ede\u6578\u578b\u5225\u90fd\u5be6\u4f5c ",(0,d.jsx)(n.code,{children:"Add"})," \u9019\u500b\u7279\u5fb5\u6240\u9700\u7684\u529f\u80fd\u3002\u53e6\u5916\uff0c\u5f9e\u539f\u59cb\u78bc\u61c9\u8a72\u4e5f\u770b\u7684\u51fa\u4f86\u5728\u9019\u500b ",(0,d.jsx)(n.code,{children:"add()"})," \u65b9\u6cd5\u7684\u53c3\u6578\u662f ",(0,d.jsx)(n.code,{children:"self"})," \u4e26\u4e0d\u662f ",(0,d.jsx)(n.code,{children:"&self"})," \u53c3\u7167\uff0c\u6240\u4ee5\u57f7\u884c\u4e86\u52a0\u6cd5\u4e4b\u5f8c\u5c31\u6703\u8f49\u79fb\u6240\u6709\u6b0a\u3002"]}),"\n",(0,d.jsxs)(n.p,{children:["\u56de\u5230\u539f\u672c\u7684\u7a0b\u5f0f\uff0c\u56e0\u70ba\u73fe\u5728\u6211\u5011\u7684 ",(0,d.jsx)(n.code,{children:"add_number()"})," \u51fd\u6578\u5df2\u7d93\u52a0\u4e0a\u9650\u5236\u4e86\uff0c\u6240\u4ee5\u9019\u6a23\u57f7\u884c\uff1a"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-rust",children:'println!("{}", add_number(1, 2));\r\nprintln!("{}", add_number(3.1, 9.8));\r\n\n'})}),"\n",(0,d.jsxs)(n.p,{children:["\u5c31\u90fd\u80fd\u6b63\u5e38\u904b\u4f5c\u4e86\u3002\u5982\u679c\u9019\u6642\u5019\u6545\u610f\u5e36\u500b ",(0,d.jsx)(n.code,{children:"bool"})," \u578b\u5225\u7d66\u5b83\u5462\uff1f"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-csharp",children:'$ cargo run\r\nerror[E0277]: cannot add `bool` to `bool`\r\n   |\r\n7  |     println!("{}", add_number(true, true));\r\n   |                    ^^^^^^^^^^ no implementation for `bool + bool`\n'})}),"\n",(0,d.jsxs)(n.p,{children:["\u56e0\u70ba ",(0,d.jsx)(n.code,{children:"bool"})," \u578b\u5225\u4e26\u6c92\u6709\u5be6\u4f5c ",(0,d.jsx)(n.code,{children:"Add"})," \u7279\u5fb5\uff08\u53ea\u6709\u6578\u5b57\u5011\u6709\uff09\uff0c\u6240\u4ee5\u7121\u6cd5\u901a\u904e\u7de8\u8b6f\u3002\u6211\u5011\u518d\u8a66\u8457\u8b93\u5b83\u8907\u96dc\u4e00\u9ede\uff0c\u5982\u679c\u5728\u51fd\u6578\u88e1\u4e0d\u53ea\u505a\u52a0\u6cd5\uff0c\u9084\u8981\u505a\u6e1b\u6cd5\u5462\uff1f\u5beb\u8d77\u4f86\u53ef\u80fd\u5c31\u6703\u8b8a\u9019\u6a23\uff1a"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-rust",children:"fn calc<T: std::ops::Add<Output = T> + std::ops::Sub<Output = T>>(a: T, b: T, c: T) -> T {\r\n    a + b - c\r\n}\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u9019\u56de\u7e3d\u5171\u6709 3 \u500b\u53c3\u6578\uff0c\u5b83\u5011\u90fd\u662f ",(0,d.jsx)(n.code,{children:"T"})," \u578b\u5225\uff0c\u4f46\u70ba\u4e86\u8981\u53ef\u4ee5 ",(0,d.jsx)(n.code,{children:"+"})," \u4e5f\u53ef\u4ee5 ",(0,d.jsx)(n.code,{children:"-"}),"\uff0c\u6240\u4ee5\u540c\u6642\u9700\u8981 ",(0,d.jsx)(n.code,{children:"Add"})," \u8ddf ",(0,d.jsx)(n.code,{children:"Sub"})," \u9019\u5169\u500b\u7279\u5fb5\u3002\u9019\u6a23\u5beb\u8d77\u4f86\u8b93\u9019\u500b ",(0,d.jsx)(n.code,{children:"T"})," \u770b\u8d77\u4f86\u6709\u5920\u56c9\u55e6\uff0c\u5229\u7528 ",(0,d.jsx)(n.code,{children:"use"})," \u95dc\u9375\u5b57\u53ef\u4ee5\u8b93\u6574\u500b\u770b\u8d77\u4f86\u77ed\u4e00\u9ede\u9ede\uff1a"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-rust",children:"use std::ops::{Add, Sub};\r\n\r\nfn calc<T: Add<Output = T> + Sub<Output = T>>(a: T, b: T, c: T) -> T {\r\n    a + b - c\r\n}\r\n\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u4f46\u9019\u500b ",(0,d.jsx)(n.code,{children:"calc()"})," \u51fd\u6578\u770b\u8d77\u4f86\u9084\u662f\u592a\u56c9\u55e6\u4e86\uff0cRust \u6709\u63d0\u4f9b\u53e6\u4e00\u7a2e\u5beb\u6cd5\uff0c\u53ef\u4ee5\u4f7f\u7528 ",(0,d.jsx)(n.code,{children:"where"})," \u95dc\u9375\u5b57\uff0c\u628a\u9019\u4e9b\u56c9\u55e6\u7684\u9650\u5236\u79fb\u5230\u65b9\u6cd5\u5b9a\u7fa9\u7684\u5f8c\u534a\u6bb5\uff1a"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-rust",children:"fn calc<T>(a: T, b: T, c: T) -> T\r\nwhere T: Add<Output = T> + Sub<Output = T>\r\n{\r\n    a + b - c\r\n}\r\n\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u4ee5\u7d50\u679c\u4f86\u8aaa\uff0c\u96d6\u7136\u9700\u8981\u5beb\u7684\u7a0b\u5f0f\u78bc\u4e26\u6c92\u6709\u6bd4\u8f03\u5c11\uff0c\u4f46\u81f3\u5c11\u8b93 ",(0,d.jsx)(n.code,{children:"calc"})," \u7684\u51fd\u6578\u7c3d\u540d\u770b\u8d77\u4f86\u6e05\u695a\u4e00\u4e9b\u3002"]}),"\n",(0,d.jsx)(n.h2,{id:"\u975c\u614b\u5206\u767c-vs-\u52d5\u614b\u5206\u767c",children:"\u975c\u614b\u5206\u767c vs \u52d5\u614b\u5206\u767c"}),"\n",(0,d.jsx)(n.p,{children:"\u5728\u300c\u7279\u5fb5\uff08Trait\uff09\u300d\u7ae0\u7bc0\u66fe\u7d93\u4ecb\u7d39\u904e\u300c\u591a\u578b\u300d\u7684\u6982\u5ff5\uff0c\u5728 Rust \u53ef\u4ee5\u900f\u904e Trait Object \u4f86\u505a\u5230\u591a\u578b\u7684\u6548\u679c\uff0c\u7576\u6642\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u5927\u6982\u662f\u9019\u6a23\u5beb\u7684\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-rust",children:"fn bungee(someone: &dyn Flyable) {\r\n    someone.fly();\r\n}\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u6211\u4e0d\u5728\u4e4e\u50b3\u9032\u4f86\u7684 ",(0,d.jsx)(n.code,{children:"someone"})," \u662f\u4ec0\u9ebc\u578b\u5225\uff0c\u53ea\u8981\u4f60\u6709\u5be6\u4f5c ",(0,d.jsx)(n.code,{children:"Flyable"})," \u7684\u7279\u5fb5\u5c31\u597d\u3002\u73fe\u5728\u5927\u5bb6\u770b\u5b8c\u6cdb\u578b\u7684\u4ecb\u7d39\uff0c\u6703\u4e0d\u6703\u89ba\u5f97\u9019\u7a2e Trait Object \u7684\u5beb\u6cd5\u597d\u50cf\u8ddf\u6cdb\u578b\u6709\u4e00\u9ede\u9ede\u50cf\uff1f\u53e6\u5916\uff0c\u524d\u9762\u7684 ",(0,d.jsx)(n.code,{children:"&dyn"})," \u53c8\u662f\u4ec0\u9ebc\u610f\u601d\uff1f"]}),"\n",(0,d.jsx)(n.p,{children:"\u5176\u5be6\u4f7f\u7528\u6cdb\u578b\u4e5f\u80fd\u505a\u5230\u591a\u578b\u7684\u6548\u679c\uff0c\u6211\u53ef\u4ee5\u628a\u539f\u672c\u7684\u7a0b\u5f0f\u78bc\u7528\u6cdb\u578b\u7684\u65b9\u5f0f\u6539\u5beb\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-rust",children:"fn bungee<T: Flyable>(someone: &T) {\r\n    someone.fly()\r\n}\r\n\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u50b3\u9032\u4f86\u7684 ",(0,d.jsx)(n.code,{children:"someone"})," \u53c3\u6578\u96d6\u7136\u53ef\u4ee5\u662f\u4efb\u610f\u7684 ",(0,d.jsx)(n.code,{children:"T"})," \u578b\u5225\uff0cRust \u4e5f\u4e0d\u5728\u4e4e\u5b83\u662f\u4ec0\u9ebc\u578b\u5225\uff0c\u4f46\u5b83\u5fc5\u9808\u6709 ",(0,d.jsx)(n.code,{children:"Flyable"})," \u7684\u7279\u5fb5\uff0c\u9019\u6a23\u57f7\u884c\u624d\u4e0d\u6703\u51fa\u932f\u3002"]}),"\n",(0,d.jsxs)(n.p,{children:["\u4e0d\u7ba1\u662f\u85c9\u7531 Trait Object \u6216\u662f\u6cdb\u578b\uff0c\u90fd\u80fd\u5be6\u73fe\u591a\u578b\u7684\u6548\u679c\u3002\u4e0d\u904e Trait Object \u4e00\u6b21\u53ea\u80fd\u6709\u4e00\u7a2e Trait\uff0c\u800c\u6cdb\u578b\u53ef\u4ee5\u900f\u904e\u52a0\u865f ",(0,d.jsx)(n.code,{children:"+"})," \u4e32\u9023\u591a\u500b Trait\uff0c\u50cf\u662f\u524d\u9762\u4ecb\u7d39\u7684 ",(0,d.jsx)(n.code,{children:"Add<Output = T> + Sub<Output = T>"}),"\u3002"]}),"\n",(0,d.jsxs)(n.p,{children:["\u53e6\u5916\u4e00\u500b\u6bd4\u8f03\u5927\u7684\u5dee\u5225\uff0c\u662f\u6cdb\u578b\u662f\u4f7f\u7528\u300c\u975c\u614b\u5206\u767c\uff08Static Dispatch\uff09\u300d\u7684\u65b9\u5f0f\u4f86\u5be6\u73fe\u591a\u578b\uff0c\u800c Trait Object \u5247\u662f\u4f7f\u7528\u300c\u52d5\u614b\u5206\u767c\uff08Dynamic Dispatch\uff09\u300d\uff0c\u524d\u9762\u770b\u5230\u7684 ",(0,d.jsx)(n.code,{children:"&dyn"})," \u5c31\u662f\u52d5\u614b\u7684\u610f\u601d\u3002"]}),"\n",(0,d.jsx)(n.p,{children:"\u975c\u614b\u5206\u767c\u662f\u6307\u5728\u7de8\u8b6f\u968e\u6bb5\u5c31\u6703\u78ba\u5b9a\u51fd\u6578\u547c\u53eb\u7684\u65b9\u5f0f\u4ee5\u53ca\u53c3\u6578\u3001\u56de\u50b3\u503c\u7684\u578b\u5225\uff0c\u524d\u9762\u63d0\u5230 Rust \u5728\u8655\u7406\u6cdb\u578b\u7684\u6642\u5019\uff0c\u6703\u5728\u7de8\u8b6f\u968e\u6bb5\u6703\u5efa\u7acb\u8a72\u5efa\u7acb\u7684\u8cc7\u6599\u7d50\u69cb\uff0c\u6240\u4ee5\u5be6\u969b\u57f7\u884c\u7684\u6642\u5019\u6548\u80fd\u4e0d\u6703\u56e0\u6b64\u800c\u6709\u6298\u6263\u3002\u975c\u614b\u5206\u767c\u7684\u597d\u8655\u662f\u57f7\u884c\u6642\u671f\u6548\u7387\u597d\uff0c\u4f46\u56e0\u70ba Rust \u5728\u7de8\u8b6f\u904e\u7a0b\u90fd\u5e6b\u4f60\u751f\u6210\u76f8\u5c0d\u61c9\u7684\u8cc7\u6599\u53ca\u51fd\u6578\uff0c\u7f3a\u9ede\u5c31\u662f\u6574\u9ad4\u7684\u7a0b\u5f0f\u78bc\u6703\u8b8a\u7684\u6bd4\u8f03\u80a5\u4e00\u9ede\uff08Code Bloat\uff09\u3002"}),"\n",(0,d.jsx)(n.p,{children:"\u76f8\u5c0d\u7684\u52d5\u614b\u5206\u767c\u662f\u5728\u904b\u884c\u6642\u624d\u6c7a\u5b9a\u9019\u4e9b\u4e8b\uff0c\u8ddf\u975c\u614b\u5206\u767c\u76f8\u6bd4\uff0c\u52d5\u614b\u5206\u767c\u7684\u9748\u6d3b\u6027\u8f03\u5927\uff0c\u4e5f\u4e0d\u6703\u50cf\u975c\u614b\u5206\u767c\u9019\u6a23\u7522\u751f\u6240\u6709\u7528\u5230\u7684\u8cc7\u6599\uff0c\u4f46\u4e5f\u56e0\u6b64\u9700\u8981\u5728\u57f7\u884c\u7684\u6642\u5019\u67e5\u627e\u53ca\u9078\u64c7\u5177\u9ad4\u5be6\u4f5c\u7684\u65b9\u5f0f\uff0c\u9748\u6d3b\u7684\u4ee3\u50f9\u5c31\u662f\u9700\u8981\u984d\u5916\u4ed8\u51fa\u4e00\u4e9b\u6548\u80fd\u3002"})]})}function a(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(o,{...e})}):o(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>l});var s=r(6540);const d={},c=s.createContext(d);function t(e){const n=s.useContext(c);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:t(e.components),s.createElement(c.Provider,{value:n},e.children)}}}]);