"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([[1547],{6880:(r,e,n)=>{n.r(e),n.d(e,{assets:()=>a,contentTitle:()=>l,default:()=>u,frontMatter:()=>t,metadata:()=>i,toc:()=>d});var c=n(4848),s=n(8453);const t={"\uff03id":"doc-markdown",title:"28-rust_\u5beb\u51fd\u5f0f\u5eab\u7d66\u81ea\u5df1\u8ddf\u5225\u4eba\u7528",description:"_\u5beb\u51fd\u5f0f\u5eab\u7d66\u81ea\u5df1\u8ddf\u5225\u4eba\u7528",keywords:["rust"],last_update:{date:"6/03/2024",author:"ttom"}},l=void 0,i={id:"\u5b78\u7fd2/rust/rustbasic/rust_\u5beb\u51fd\u5f0f\u5eab\u7d66\u81ea\u5df1\u8ddf\u5225\u4eba\u7528",title:"28-rust_\u5beb\u51fd\u5f0f\u5eab\u7d66\u81ea\u5df1\u8ddf\u5225\u4eba\u7528",description:"_\u5beb\u51fd\u5f0f\u5eab\u7d66\u81ea\u5df1\u8ddf\u5225\u4eba\u7528",source:"@site/docs/\u5b78\u7fd2/rust/rustbasic/28-rust_\u5beb\u51fd\u5f0f\u5eab\u7d66\u81ea\u5df1\u8ddf\u5225\u4eba\u7528.md",sourceDirName:"\u5b78\u7fd2/rust/rustbasic",slug:"/\u5b78\u7fd2/rust/rustbasic/rust_\u5beb\u51fd\u5f0f\u5eab\u7d66\u81ea\u5df1\u8ddf\u5225\u4eba\u7528",permalink:"/my-blog/docs/\u5b78\u7fd2/rust/rustbasic/rust_\u5beb\u51fd\u5f0f\u5eab\u7d66\u81ea\u5df1\u8ddf\u5225\u4eba\u7528",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:28,frontMatter:{"\uff03id":"doc-markdown",title:"28-rust_\u5beb\u51fd\u5f0f\u5eab\u7d66\u81ea\u5df1\u8ddf\u5225\u4eba\u7528",description:"_\u5beb\u51fd\u5f0f\u5eab\u7d66\u81ea\u5df1\u8ddf\u5225\u4eba\u7528",keywords:["rust"],last_update:{date:"6/03/2024",author:"ttom"}},sidebar:"tutorialSidebar",previous:{title:"27-rust_\u628a\u51fd\u6578\u4e1f\u4f86\u4e1f\u53bb\u7684\u9ad8\u968e\u51fd\u6578",permalink:"/my-blog/docs/\u5b78\u7fd2/rust/rustbasic/rust_\u628a\u51fd\u6578\u4e1f\u4f86\u4e1f\u53bb\u7684\u9ad8\u968e\u51fd\u6578"},next:{title:"rust\u7279\u5225\u8a9e\u6cd5",permalink:"/my-blog/docs/\u5b78\u7fd2/rust/rust\u7279\u5225\u8a9e\u6cd5"}},a={},d=[{value:"\u5efa\u7acb\u51fd\u5f0f\u5eab",id:"\u5efa\u7acb\u51fd\u5f0f\u5eab",level:2}];function o(r){const e={code:"code",h2:"h2",p:"p",pre:"pre",...(0,s.R)(),...r.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(e.p,{children:["\u4e00\u822c\u6211\u5011\u5728\u65b0\u589e\u4e00\u500b Rust \u5c08\u6848\u7684\u6642\u5019\uff0c\u5c31\u662f\u76f4\u63a5 ",(0,c.jsx)(e.code,{children:"cargo new"})," \u4e0b\u53bb\uff0c\u7136\u5f8c\u5c31\u6703\u751f\u6210 ",(0,c.jsx)(e.code,{children:"Cargo.toml"})," \u8ddf ",(0,c.jsx)(e.code,{children:"src/main.rs"}),"\uff0c\u6700\u5f8c\u5beb\u4e00\u5beb\u5c31 ",(0,c.jsx)(e.code,{children:"cargo run"})," \u6216 ",(0,c.jsx)(e.code,{children:"cargo build"})," \u5c31\u80fd\u7522\u51fa\u53ef\u4ee5\u57f7\u884c\u7684\u6a94\u6848\u3002\u4e0d\u904e\u5728\u5efa\u7acb\u5c08\u6848\u7684\u6642\u5019\u5982\u679c\u591a\u7d66\u4e00\u500b ",(0,c.jsx)(e.code,{children:"--lib"})," \u7684\u8a71\uff0c\u6703\u5efa\u7acb\u4e00\u500b\u51fd\u5f0f\u5eab\u5c08\u6848\uff1a"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-go",children:"$ cargo new calculator --lib\r\nCreated library `calculator` package\n"})}),"\n",(0,c.jsxs)(e.p,{children:["\u6240\u8b02\u7684\u51fd\u5f0f\u5eab\u5c08\u6848\uff0c\u5c31\u662f\u5230\u6642\u5019\u5b83\u53ef\u4ee5\u88ab\u5176\u5b83\u7684 Rust \u5c08\u6848\u4f7f\u7528\u3002\u8b1b\u7684\u597d\u50cf\u5f88\u53b2\u5bb3\uff0c\u4f46\u4f60\u53ea\u8981\u6253\u958b\u5c08\u6848\u5c31\u6703\u767c\u73fe\u6839\u672c\u6c92\u6709\u591a\u795e\u5947\uff0c\u5c31\u662f\u628a\u539f\u672c\u7684 ",(0,c.jsx)(e.code,{children:"src/main.rs"})," \u63db\u6210 ",(0,c.jsx)(e.code,{children:"src/lib.rs"})," \u7f77\u4e86\u3002"]}),"\n",(0,c.jsxs)(e.p,{children:["\u5728 Rust \u88e1\uff0c",(0,c.jsx)(e.code,{children:"main.rs"})," \u4e3b\u8981\u662f\u7528\u4f86\u7de8\u8b6f\u3001\u5efa\u7acb\u57f7\u884c\u6a94\uff0c\u88e1\u9762\u6703\u9700\u8981\u6709\u4e00\u500b ",(0,c.jsx)(e.code,{children:"main()"})," \u51fd\u6578\uff0c\u9019\u662f\u6574\u500b\u7a0b\u5f0f\u7684\u9032\u5165\u9ede\uff1b\u800c ",(0,c.jsx)(e.code,{children:"lib.rs"})," \u5247\u662f\u53ef\u4ee5\u91cd\u8907\u88ab\u4f7f\u7528\u7684\u7a0b\u5f0f\u78bc\uff0c\u53ef\u4ee5\u88ab\u5176\u5b83 Rust \u7a0b\u5f0f\u5f15\u5165\u4f7f\u7528\uff0c\u5b83\u4e0d\u9700\u8981\u4ec0\u9ebc\u7279\u5225\u7684\u9032\u5165\u9ede\uff0c\u5c31\u53ea\u8981\u653e\u4f60\u60f3\u5beb\u7684\u6a21\u7d44\u3001Struct \u6216\u662f\u51fd\u6578\u7b49\u5167\u5bb9\u3002\u51fd\u5f0f\u5eab\u578b\u7684\u5c08\u6848\u56e0\u70ba\u4e0d\u6703\u7de8\u8b6f\u6210\u53ef\u57f7\u884c\u6a94\uff0c\u53ea\u80fd\u88ab\u7576\u505a\u7b2c\u4e09\u65b9\u7684\u5957\u4ef6\u5f15\u5165\u3001\u4f7f\u7528\uff0c\u6240\u4ee5\u7576\u4f60\u8a66\u8457\u57f7\u884c\u5b83\u7684\u6642\u5019\uff1a"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-go",children:"$ cargo run\r\nerror: a bin target must be available for `cargo run`\r\n\n"})}),"\n",(0,c.jsx)(e.p,{children:"Rust \u6703\u544a\u8a34\u4f60\u6c92\u8fa6\u6cd5\u57f7\u884c\u3002"}),"\n",(0,c.jsxs)(e.p,{children:["\u5728\u6bd4\u8f03\u65e9\u671f\u7684 Rust \u7248\u672c\uff0c\u5982\u679c\u60f3\u8981\u5efa\u7acb\u4e00\u500b\u53ef\u7522\u751f\u57f7\u884c\u6a94\u7684\u5c08\u6848\uff0c\u9700\u8981\u4e3b\u52d5\u52a0\u4e0a ",(0,c.jsx)(e.code,{children:"--bin"})," \u53c3\u6578\uff0c\u5728\u8f03\u65b0\u7684\u7248\u672c\u4e2d ",(0,c.jsx)(e.code,{children:"--bin"})," \u5df2\u7d93\u662f\u9810\u8a2d\u503c\uff0c\u6240\u4ee5\u5982\u679c\u8981\u5efa\u7acb\u51fd\u5f0f\u5eab\u5c08\u6848\u9700\u8981\u4e3b\u52d5\u52a0\u4e0a ",(0,c.jsx)(e.code,{children:"--lib"})," \u53c3\u6578\u3002"]}),"\n",(0,c.jsx)(e.p,{children:"\u63a5\u8457\u6211\u5011\u5c31\u8a66\u8457\u52d5\u624b\u4f86\u505a\u500b\u51fd\u5f0f\u5eab\u5427 :)"}),"\n",(0,c.jsx)(e.h2,{id:"\u5efa\u7acb\u51fd\u5f0f\u5eab",children:"\u5efa\u7acb\u51fd\u5f0f\u5eab"}),"\n",(0,c.jsxs)(e.p,{children:["\u6253\u958b\u525b\u525b\u5efa\u7acb\u597d\u7684\u5c08\u6848\uff0c\u88e1\u9762\u7684 ",(0,c.jsx)(e.code,{children:"src/lib.rs"})," \u61c9\u8a72\u6709\u4e00\u4e9b\u6e2c\u8a66\u7528\u7684\u6e2c\u8a66\uff0c\u53ef\u4ee5\u5148\u4e0d\u7406\u5b83\u6216\u662f\u628a\u5b83\u5011\u5148\u522a\u9664\u3002\u9019\u56de\u9084\u662f\u62ff\u81ea\u5df1\u672c\u696d\u7684 BMI \u8a08\u7b97\u6a5f\uff0c\u4e0d\u904e\u65e2\u7136\u662f\u8981\u5beb\u51fd\u5f0f\u5eab\u7d66\u5225\u4eba\u7528\uff0c\u6e2c\u8a66\u5c31\u7279\u5225\u91cd\u8981\u4e86\u3002\u6211\u5148\u5728\u5c08\u6848\u88e1\u958b\u4e00\u500b ",(0,c.jsx)(e.code,{children:"tests/bmi_test.rs"})," \u6a94\u6848\uff0c\u4e26\u5148\u628a test case \u5beb\u597d\uff1a"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-rust",children:"extern crate calculator;\r\n\r\n#[test]\r\nfn bmi_test() {\r\n    let result = calculator::bmi(180, 65);\r\n    assert_eq!(result, Ok(20.1))\r\n}\r\n\r\n#[test]\r\nfn bmi_test_invalid() {\r\n    let result = calculator::bmi(0, 65);\r\n    assert!(result.is_err());\r\n}\n"})}),"\n",(0,c.jsxs)(e.p,{children:["\u5982\u679c\u4f60\u6c92\u6709\u990a\u5c0f\u7cbe\u9748\u7684\u8a71\uff0c\u56e0\u70ba\u5be6\u4f5c\u7a0b\u5f0f\u90fd\u9084\u6c92\u5beb\uff0c\u6240\u4ee5\u57f7\u884c\u6e2c\u8a66\u4e4b\u5f8c\u4e00\u5b9a\u662f\u6703\u51fa\u932f\u7684\u3002\u6240\u4ee5\u63a5\u8457\u628a\u5be6\u4f5c\u88dc\u4e0a\uff0c\u6211\u76f4\u63a5\u5beb\u5728 ",(0,c.jsx)(e.code,{children:"src/lib.rs"})," \u88e1\uff1a"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-rust",children:'pub fn bmi<T, U>(height: T, weight: U) -> Result<f64, String>\r\nwhere\r\n    T: Into<f64>,\r\n    U: Into<f64>,\r\n{\r\n    let h = height.into();\r\n    let w = weight.into();\r\n\r\n    if h <= 0.0 || w <= 0.0 {\r\n        return Err("\u8f38\u5165\u503c\u6709\u8aa4".to_string());\r\n    }\r\n\r\n    let bmi = w / (h / 100.0 * h / 100.0);\r\n    Ok((bmi * 10.0).round() / 10.0)\r\n}\r\n\n'})}),"\n",(0,c.jsx)(e.p,{children:"\u5be6\u4f5c\u7a0b\u5f0f\u78bc\u61c9\u8a72\u6c92\u6709\u4ec0\u9ebc\u65b0\u6771\u897f\u3002\u51fd\u5f0f\u5eab\u505a\u597d\u4e4b\u5f8c\uff0c\u901a\u5e38\u662f\u6703\u4e0a\u50b3\u4e00\u4efd\u5230 crates.io \u7db2\u7ad9\u8ddf\u5927\u5bb6\u5206\u4eab\u3001\u5171\u7528\u3002\u4e0a\u50b3\u5230 crates.io \u9700\u8981\u5148\u7533\u8acb\u4e00\u500b\u7db2\u7ad9\u4e0a\u7684\u5e33\u865f\uff0c\u53ea\u8981\u4f60\u9019\u500b\u5957\u4ef6\u7684\u540d\u7a31\u6c92\u6709\u8ddf\u5225\u4eba\u7684\u91cd\u8907\uff0c\u7167\u8457\u5b98\u7db2\u7684\u8aaa\u660e\u505a\u61c9\u8a72\u5c31\u80fd\u628a\u4f60\u7684\u5c08\u6848\u63a8\u4e00\u4efd\u4e0a\u53bb\u3002"}),"\n",(0,c.jsx)(e.p,{children:"\u4e0d\u904e\u5982\u679c\u4f60\u9084\u6c92\u6253\u7b97\u4e0a\u50b3\u5230 crates.io \u7684\u8a71\uff0c\u53ef\u4ee5\u5148\u5728\u81ea\u5df1\u672c\u6a5f\u8a66\u73a9\u770b\u770b\u3002\u6211\u5011\u5148\u958b\u4e00\u500b\u65b0\u7684\u5c08\u6848\uff1a"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-rust",children:"$ cargo new hello-bmi\r\nCreated binary (application) `hello-bmi` package\r\n\n"})}),"\n",(0,c.jsxs)(e.p,{children:["\u56e0\u70ba\u8981\u505a\u4e00\u500b\u53ef\u57f7\u884c\u7684\u6a94\u6848\uff0c\u6240\u4ee5\u9019\u56de\u6211\u5011\u5c31\u4e0d\u52a0 ",(0,c.jsx)(e.code,{children:"--lib"})," \u53c3\u6578\u3002\u63a5\u8457\u6253\u958b ",(0,c.jsx)(e.code,{children:"Cargo.toml"}),"\uff0c\u5728 ",(0,c.jsx)(e.code,{children:"[dependencies]"})," \u6bb5\u843d\u5e95\u4e0b\u52a0\u4e0a\u5957\u4ef6\u7684\u540d\u7a31\u4ee5\u53ca\u5b83\u7684\u8def\u5f91\uff1a"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-toml",children:'[dependencies]\r\ncalculator = { path = "../calculator" }\r\n\n'})}),"\n",(0,c.jsxs)(e.p,{children:["\u5f8c\u9762\u90a3\u500b\u5957\u4ef6\u7684\u8def\u5f91\u5c31\u8acb\u4f9d\u5404\u4f4d\u7684\u5be6\u969b\u60c5\u6cc1\u9032\u884c\u4fee\u6539\u3002\u5982\u679c\u4f60\u89ba\u5f97\u4e0a\u50b3\u5230 crates.io \u592a\u6b63\u5f0f\uff0c\u4f46\u53c8\u60f3\u8ddf\u670b\u53cb\u5206\u4eab\u7684\u8a71\uff0c\u4f60\u4e5f\u53ef\u4ee5\u4e0a\u50b3\u5230\u81ea\u5df1\u7684 GitHub \u4e0a\uff0c\u7136\u5f8c\u628a ",(0,c.jsx)(e.code,{children:"path"})," \u6539\u6210 ",(0,c.jsx)(e.code,{children:"git"}),"\uff0c\u518d\u628a\u8def\u5f91\u6307\u5411\u4f60\u7684 GitHub Repo\uff1a"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-toml",children:'[dependencies]\r\n# \u53ef\u4ee5\u662f\u672c\u6a5f\r\n# calculator = {path = "../calculator"}\r\n# \u53ef\u4ee5\u662fgithub\r\n# calculator = { git = "https://github.com/kaochenlong/bmi-calculator-lib.git", branch = "main" }\r\n\r\n# \u53ef\u4ee5\u6539\u540d\r\nbmi_calc = {path = "../calculator", package = "calculator"}\r\n\n'})}),"\n",(0,c.jsxs)(e.p,{children:["\u8abf\u6574 ",(0,c.jsx)(e.code,{children:"branch"})," \u53ef\u4ee5\u7528\u4f86\u6e2c\u8a66\u5728\u5176\u5b83\u5206\u652f\u7684\u6548\u679c\uff0c\u4f46\u5982\u679c\u662f\u9810\u8a2d\u7684\u5206\u652f\u7684\u8a71\uff0c",(0,c.jsx)(e.code,{children:"branch"})," \u53ef\u4ee5\u7701\u7565\u4e0d\u7528\u7279\u5225\u5beb\u3002\u56e0\u70ba\u9019\u500b\u5c08\u6848\u6211\u5df2\u516c\u958b\u4e0a\u50b3\u5230 GitHub \u4e0a\uff0c\u6240\u4ee5\u5404\u4f4d\u61c9\u8a72\u5982\u679c\u7167\u8457\u505a\u7684\u8a71\uff0c\u4e5f\u53ef\u4ee5\u5f9e\u6211\u7684 Repo \u53d6\u5f97\u5beb\u597d\u7684\u5167\u5bb9\u3002"]}),"\n",(0,c.jsxs)(e.p,{children:["\u63a5\u8457\u7de8\u8f2f ",(0,c.jsx)(e.code,{children:"src/main.rs"})," \u6a94\u6848\uff1a"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-rust",children:'fn main() {\r\n    let result = calculator::bmi(170, 65);\r\n\r\n    match result {\r\n        Ok(bmi) => {\r\n            println!("BMI: {}", bmi);\r\n        },\r\n        Err(message) => {\r\n            println!("{message}")\r\n        }\r\n    }\r\n}\r\n\n'})}),"\n",(0,c.jsxs)(e.p,{children:["\u56e0\u70ba\u56de\u50b3\u503c\u662f\u500b ",(0,c.jsx)(e.code,{children:"Result"}),"\uff0c\u6240\u4ee5\u9019\u88e1\u6211\u7528 ",(0,c.jsx)(e.code,{children:"match"})," \u4f86\u8655\u7406\u5b83\uff0c\u57f7\u884c ",(0,c.jsx)(e.code,{children:"cargo run"})," \u61c9\u8a72\u5c31\u80fd\u770b\u5230\u7d50\u679c\u4e86\uff1a"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-makefile",children:"$ cargo run\r\nBMI: 22.5\r\n\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u6253\u5b8c\u6536\u5de5\uff01"}),"\n",(0,c.jsx)(e.p,{children:"\u662f\u8aaa\uff0c\u5982\u679c\u6709\u500b\u5957\u4ef6\u540d\u7a31\u4f60\u4e0d\u559c\u6b61\u6216\u662f\u89ba\u5f97\u53ef\u8b80\u6027\u4e0d\u592a\u597d\uff0c\u4f60\u6c92\u8fa6\u6cd5\u5e6b\u5b83\u6539\u540d\u5b57\uff0c\u4f46\u53ef\u4ee5\u5728\u5f15\u5165\u4f7f\u7528\u7684\u6642\u5019\u5e6b\u5b83\u6539\u4e00\u4e0b\uff1a"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-toml",children:'[dependencies]\r\nbmi_calc = { path = "/tmp/calculator", package = "calculator" }\r\n\n'})}),"\n",(0,c.jsxs)(e.p,{children:["\u539f\u672c\u5957\u4ef6\u540d\u7a31\u662f ",(0,c.jsx)(e.code,{children:"calculator"}),"\uff0c\u5982\u679c\u9700\u8981\u7684\u8a71\u53ef\u4ee5\u7d66\u5b83\u500b\u5225\u540d\u53eb\u505a ",(0,c.jsx)(e.code,{children:"bmi_calc"}),"\uff0c\u9019\u6a23\u5728 ",(0,c.jsx)(e.code,{children:"main.rs"})," \u88e1\u7684\u7a0b\u5f0f\u78bc\u4e5f\u8981\u7a0d\u5fae\u8abf\u6574\u4e00\u4e0b\uff1a"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-rust",children:"let result = bmi_calc::bmi(170, 65);\r\n\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u9019\u6a23\u5c31\u884c\u4e86 :)"})]})}function u(r={}){const{wrapper:e}={...(0,s.R)(),...r.components};return e?(0,c.jsx)(e,{...r,children:(0,c.jsx)(o,{...r})}):o(r)}},8453:(r,e,n)=>{n.d(e,{R:()=>l,x:()=>i});var c=n(6540);const s={},t=c.createContext(s);function l(r){const e=c.useContext(t);return c.useMemo((function(){return"function"==typeof r?r(e):{...e,...r}}),[e,r])}function i(r){let e;return e=r.disableParentContext?"function"==typeof r.components?r.components(s):r.components||s:l(r.components),c.createElement(t.Provider,{value:e},r.children)}}}]);